{"ID":"20230817161942-cucxs8e","Spec":"1","Type":"NodeDocument","Properties":{"id":"20230817161942-cucxs8e","title":"mapreduce的工作机制","updated":"20230817161942"},"Children":[{"ID":"20230817161943-8nex3wr","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20230817161943-8nex3wr","updated":"20230817161943"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"mapreduce的工作机制"}]},{"ID":"20230817161944-2vwkvba","Type":"NodeHTMLBlock","Data":"\u003cdiv\u003e\n\u003cimg src=\"C:\\Users\\HHH\\Desktop\\mapreduce在yarn中的执行流程.png\" alt=\"mapreduce在yarn中的执行流程\" style=\"zoom: 67%;\" /\u003e\n\u003c/div\u003e","HtmlBlockType":7,"Properties":{"id":"20230817161944-2vwkvba","updated":"20230817161944"}},{"ID":"20230817161945-ksr7xah","Type":"NodeParagraph","Properties":{"id":"20230817161945-ksr7xah","updated":"20230817161945"},"Children":[{"Type":"NodeText","Data":"上图中 有以下五个独立的实体："}]},{"ID":"20230817161946-ivnc0fp","Type":"NodeList","ListData":{"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161946-ivnc0fp","updated":"20230817161946"},"Children":[{"ID":"20230817161947-gf5dd2c","Type":"NodeListItem","Data":"-","ListData":{"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161947-gf5dd2c","updated":"20230817161947"},"Children":[{"ID":"20230817161948-zsrv71h","Type":"NodeParagraph","Properties":{"id":"20230817161948-zsrv71h","updated":"20230817161948"},"Children":[{"Type":"NodeText","Data":"客户端，提交MapReduce作业"}]}]},{"ID":"20230817161949-p660r0w","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161949-p660r0w","updated":"20230817161949"},"Children":[{"ID":"20230817161950-unfl66f","Type":"NodeParagraph","Properties":{"id":"20230817161950-unfl66f","updated":"20230817161950"},"Children":[{"Type":"NodeText","Data":"Yarn资源管理器 负责协调集群上计算机资源的分配"}]}]},{"ID":"20230817161951-aa29ujh","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161951-aa29ujh","updated":"20230817161951"},"Children":[{"ID":"20230817161952-r6euqwo","Type":"NodeParagraph","Properties":{"id":"20230817161952-r6euqwo","updated":"20230817161952"},"Children":[{"Type":"NodeText","Data":"Yarn的节点管理器 负责启动和监视集群中机器上的计算容器"}]}]},{"ID":"20230817161953-tosjxd9","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161953-tosjxd9","updated":"20230817161953"},"Children":[{"ID":"20230817161954-bweuvnh","Type":"NodeParagraph","Properties":{"id":"20230817161954-bweuvnh","updated":"20230817161954"},"Children":[{"Type":"NodeText","Data":"mapreduce的application master(应用程序主机) 负责协调运行mapreduce作业的任务 它和mapreduce任务在容器中运行 这些容器由资源管理器分配 并由节点管理器进行管理"}]}]},{"ID":"20230817161955-8wy67ih","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161955-8wy67ih","updated":"20230817161955"},"Children":[{"ID":"20230817161956-dwat4m2","Type":"NodeParagraph","Properties":{"id":"20230817161956-dwat4m2","updated":"20230817161956"},"Children":[{"Type":"NodeText","Data":"分布式文件系统 用于与其他实体间共享作业文件"}]}]}]},{"ID":"20230817161957-a6hah4s","Type":"NodeParagraph","Properties":{"id":"20230817161957-a6hah4s","updated":"20230817161957"},"Children":[{"Type":"NodeText","Data":"执行过程："}]},{"ID":"20230817161958-lv1y96s","Type":"NodeParagraph","Properties":{"id":"20230817161958-lv1y96s","updated":"20230817161958"},"Children":[{"Type":"NodeText","Data":"1、首先客户端通过job的submit方法提交一个作业 提交作业后waitforcomlecation()也会轮询作业的进度"}]},{"ID":"20230817161959-g66jso9","Type":"NodeParagraph","Properties":{"id":"20230817161959-g66jso9","updated":"20230817161959"},"Children":[{"Type":"NodeText","Data":"2、向资源管理器请求一个新应用的id 用于mapreduce作业id"}]},{"ID":"20230817161960-gfshe82","Type":"NodeParagraph","Properties":{"id":"20230817161960-gfshe82","updated":"20230817161960"},"Children":[{"Type":"NodeText","Data":"3、将运行作业所需要的资源（包括作业的jar文件、配置文件、计算所得的输入分片）复制到一个以作业id命名的目录下的共享文件中"}]},{"ID":"20230817161961-lbrkdho","Type":"NodeParagraph","Properties":{"id":"20230817161961-lbrkdho","updated":"20230817161961"},"Children":[{"Type":"NodeText","Data":"4、调用资源管理器的submitapplication方法"}]},{"ID":"20230817161962-zb0jbx0","Type":"NodeParagraph","Properties":{"id":"20230817161962-zb0jbx0","updated":"20230817161962"},"Children":[{"Type":"NodeText","Data":"5、资源管理器收到调用它的submitapplication方法的消息后 便将请求传递给yarn的调度器 调度器分配一个容器 然后资源管理器在节点管理器的管理下在容器中启动application master的进程"}]},{"ID":"20230817161963-bj4nkhz","Type":"NodeParagraph","Properties":{"id":"20230817161963-bj4nkhz","updated":"20230817161963"},"Children":[{"Type":"NodeText","Data":"6、application master对job进行初始化 初始化是通过创建多个薄记对象以保持对作业进度的跟踪来完成的"}]},{"ID":"20230817161964-gull0ab","Type":"NodeParagraph","Properties":{"id":"20230817161964-gull0ab","updated":"20230817161964"},"Children":[{"Type":"NodeText","Data":"7、application master接收来自共享文件系统的在客户端计算的输入分片 然后对每一个分片创建一个map任务对象 以及多个reduce任务对象 如果是uber任务（在新的机器启动的消耗已经大于了运行该任务的消耗 该任务就会在application master这个容器中一起运行）"}]},{"ID":"20230817161965-m8btt74","Type":"NodeParagraph","Properties":{"id":"20230817161965-m8btt74","updated":"20230817161965"},"Children":[{"Type":"NodeText","Data":"8、如果作业不适合作为uber任务 那么application master就会为该作业所有的map和reduce任务向资源管理器请求容器"}]},{"ID":"20230817161966-6z88dhk","Type":"NodeParagraph","Properties":{"id":"20230817161966-6z88dhk","updated":"20230817161966"},"Children":[{"Type":"NodeText","Data":"9、一旦资源管理器的调度器为任务分配了一个特定节点的容器 application master就通过与该节点管理器通信来启动容器"}]},{"ID":"20230817161967-poen9xm","Type":"NodeParagraph","Properties":{"id":"20230817161967-poen9xm","updated":"20230817161967"},"Children":[{"Type":"NodeText","Data":"10、然后该任务由主类为yarnchild的一个java应用程序执行 在它运行任务之前 会将共享文件中的任务资源本地化"}]},{"ID":"20230817161968-g9sxpqf","Type":"NodeParagraph","Properties":{"id":"20230817161968-g9sxpqf","updated":"20230817161968"},"Children":[{"Type":"NodeText","Data":"11、运行map任务或者reduce任务"}]},{"ID":"20230817161969-edr27z4","Type":"NodeParagraph","Properties":{"id":"20230817161969-edr27z4","updated":"20230817161969"},"Children":[{"Type":"NodeText","Data":"12、当application master 收到最后一个任务完成时 便会把作业的状态设置为成功 然后job在轮询状态时 便知道任务执行成功"}]}]}