{"ID":"20230817161859-ykni6uz","Spec":"1","Type":"NodeDocument","Properties":{"id":"20230817161859-ykni6uz","title":"日志引擎系列","updated":"20230817161859"},"Children":[{"ID":"20230817161860-jxsx92s","Type":"NodeParagraph","Properties":{"id":"20230817161860-jxsx92s","updated":"20230817161860"},"Children":[{"Type":"NodeText","Data":"clickhouse中的日志表引擎对比"}]},{"ID":"20230817161861-wlsjxwh","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20230817161861-wlsjxwh","updated":"20230817161861"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"# ","Properties":{"id":""}},{"Type":"NodeText","Data":"日志引擎系列"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://clickhouse.com/docs/zh/engines/table-engines/log-family/#table_engines-log-engine-family","TextMarkTextContent":" "}]},{"ID":"20230817161862-6x6o8k4","Type":"NodeParagraph","Properties":{"id":"20230817161862-6x6o8k4","updated":"20230817161862"},"Children":[{"Type":"NodeText","Data":"这些引擎是为了需要写入许多小数据量（少于一百万行）的表的场景而开发的。"}]},{"ID":"20230817161863-jug1tsp","Type":"NodeParagraph","Properties":{"id":"20230817161863-jug1tsp","updated":"20230817161863"},"Children":[{"Type":"NodeText","Data":"这系列的引擎有："}]},{"ID":"20230817161864-qkgigog","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161864-qkgigog","updated":"20230817161864"},"Children":[{"ID":"20230817161865-qud96yr","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161865-qud96yr","updated":"20230817161865"},"Children":[{"ID":"20230817161866-p19zpze","Type":"NodeParagraph","Properties":{"id":"20230817161866-p19zpze","updated":"20230817161866"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://clickhouse.com/docs/zh/engines/table-engines/log-family/stripelog/","TextMarkTextContent":"StripeLog"}]}]},{"ID":"20230817161867-n2mg9uo","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161867-n2mg9uo","updated":"20230817161867"},"Children":[{"ID":"20230817161868-k2q46lm","Type":"NodeParagraph","Properties":{"id":"20230817161868-k2q46lm","updated":"20230817161868"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://clickhouse.com/docs/zh/engines/table-engines/log-family/log/","TextMarkTextContent":"日志"}]}]},{"ID":"20230817161869-mjpx2v8","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161869-mjpx2v8","updated":"20230817161869"},"Children":[{"ID":"20230817161870-d0r9ibw","Type":"NodeParagraph","Properties":{"id":"20230817161870-d0r9ibw","updated":"20230817161870"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://clickhouse.com/docs/zh/engines/table-engines/log-family/tinylog/","TextMarkTextContent":"TinyLog"}]}]}]},{"ID":"20230817161871-9s4zzgr","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20230817161871-9s4zzgr","updated":"20230817161871"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"共同属性"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://clickhouse.com/docs/zh/engines/table-engines/log-family/#table_engines-log-engine-family-common-properties","TextMarkTextContent":" "}]},{"ID":"20230817161872-ro1asbu","Type":"NodeParagraph","Properties":{"id":"20230817161872-ro1asbu","updated":"20230817161872"},"Children":[{"Type":"NodeText","Data":"引擎："}]},{"ID":"20230817161873-4iccbij","Type":"NodeList","ListData":{"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161873-4iccbij","updated":"20230817161873"},"Children":[{"ID":"20230817161874-8o2d05v","Type":"NodeListItem","Data":"-","ListData":{"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161874-8o2d05v","updated":"20230817161874"},"Children":[{"ID":"20230817161875-odlywzp","Type":"NodeParagraph","Properties":{"id":"20230817161875-odlywzp","updated":"20230817161875"},"Children":[{"Type":"NodeText","Data":"数据存储在磁盘上。"}]}]},{"ID":"20230817161876-jpnbhvt","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161876-jpnbhvt","updated":"20230817161876"},"Children":[{"ID":"20230817161877-i0esmz4","Type":"NodeParagraph","Properties":{"id":"20230817161877-i0esmz4","updated":"20230817161877"},"Children":[{"Type":"NodeText","Data":"写入时将数据追加在文件末尾。"}]}]},{"ID":"20230817161878-giecv2z","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161878-giecv2z","updated":"20230817161878"},"Children":[{"ID":"20230817161879-3u3twj4","Type":"NodeParagraph","Properties":{"id":"20230817161879-3u3twj4","updated":"20230817161879"},"Children":[{"Type":"NodeText","Data":"不支持"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://clickhouse.com/docs/zh/engines/table-engines/log-family/#alter-mutations","TextMarkTextContent":"突变"},{"Type":"NodeText","Data":"操作。"}]}]},{"ID":"20230817161880-9shcubf","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161880-9shcubf","updated":"20230817161880"},"Children":[{"ID":"20230817161881-h5kzdg6","Type":"NodeParagraph","Properties":{"id":"20230817161881-h5kzdg6","updated":"20230817161881"},"Children":[{"Type":"NodeText","Data":"不支持索引。"}]},{"ID":"20230817161882-0c0e4vk","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230817161882-0c0e4vk","updated":"20230817161882"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"这意味着 `SELECT` 在范围查询时效率不高。\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]}]},{"ID":"20230817161883-ahxxxqx","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161883-ahxxxqx","updated":"20230817161883"},"Children":[{"ID":"20230817161884-7m6fk6y","Type":"NodeParagraph","Properties":{"id":"20230817161884-7m6fk6y","updated":"20230817161884"},"Children":[{"Type":"NodeText","Data":"非原子地写入数据。"}]},{"ID":"20230817161885-dybdzo5","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230817161885-dybdzo5","updated":"20230817161885"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"如果某些事情破坏了写操作，例如服务器的异常关闭，你将会得到一张包含了损坏数据的表。\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]}]}]},{"ID":"20230817161886-u2b94cw","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20230817161886-u2b94cw","updated":"20230817161886"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"差异"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://clickhouse.com/docs/zh/engines/table-engines/log-family/#table_engines-log-engine-family-differences","TextMarkTextContent":" "}]},{"ID":"20230817161887-6lredix","Type":"NodeParagraph","Properties":{"id":"20230817161887-6lredix","updated":"20230817161887"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"Log"},{"Type":"NodeText","Data":" 和 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"StripeLog"},{"Type":"NodeText","Data":" 引擎支持："}]},{"ID":"20230817161888-qwzt0xq","Type":"NodeList","ListData":{"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161888-qwzt0xq","updated":"20230817161888"},"Children":[{"ID":"20230817161889-ivonxbf","Type":"NodeListItem","Data":"-","ListData":{"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161889-ivonxbf","updated":"20230817161889"},"Children":[{"ID":"20230817161890-jsbktus","Type":"NodeParagraph","Properties":{"id":"20230817161890-jsbktus","updated":"20230817161890"},"Children":[{"Type":"NodeText","Data":"并发访问数据的锁。"}]},{"ID":"20230817161891-fq1c6o9","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230817161891-fq1c6o9","updated":"20230817161891"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"`INSERT` 请求执行过程中表会被锁定，并且其他的读写数据的请求都会等待直到锁定被解除。如果没有写数据的请求，任意数量的读请求都可以并发执行。\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]}]},{"ID":"20230817161892-l1pjgkh","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161892-l1pjgkh","updated":"20230817161892"},"Children":[{"ID":"20230817161893-efo8d0y","Type":"NodeParagraph","Properties":{"id":"20230817161893-efo8d0y","updated":"20230817161893"},"Children":[{"Type":"NodeText","Data":"并行读取数据。"}]},{"ID":"20230817161894-kbasqnp","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230817161894-kbasqnp","updated":"20230817161894"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"在读取数据时，ClickHouse 使用多线程。 每个线程处理不同的数据块。\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]}]}]},{"ID":"20230817161895-a2mtnvj","Type":"NodeParagraph","Properties":{"id":"20230817161895-a2mtnvj","updated":"20230817161895"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"Log"},{"Type":"NodeText","Data":" 引擎为表中的每一列使用不同的文件。"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"StripeLog"},{"Type":"NodeText","Data":" 将所有的数据存储在一个文件中。因此 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"StripeLog"},{"Type":"NodeText","Data":" 引擎在操作系统中使用更少的描述符，但是 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"Log"},{"Type":"NodeText","Data":" 引擎提供更高的读性能。"}]},{"ID":"20230817161896-ncjpqwo","Type":"NodeParagraph","Properties":{"id":"20230817161896-ncjpqwo","updated":"20230817161896"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"TinyLog"},{"Type":"NodeText","Data":" 引擎是该系列中最简单的引擎并且提供了最少的功能和最低的性能。"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"TinyLog"},{"Type":"NodeText","Data":" 引擎不支持并行读取和并发数据访问，并将每一列存储在不同的文件中。它比其余两种支持并行读取的引擎的读取速度更慢，并且使用了和 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"Log"},{"Type":"NodeText","Data":" 引擎同样多的描述符。你可以在简单的低负载的情景下使用它。"}]},{"ID":"20230817161897-c80lnxt","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20230817161897-c80lnxt","updated":"20230817161897"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"# ","Properties":{"id":""}},{"Type":"NodeText","Data":"TinyLog"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://clickhouse.com/docs/zh/engines/table-engines/log-family/tinylog/#tinylog","TextMarkTextContent":" "}]},{"ID":"20230817161898-a2h55js","Type":"NodeParagraph","Properties":{"id":"20230817161898-a2h55js","updated":"20230817161898"},"Children":[{"Type":"NodeText","Data":"最简单的表引擎，用于将数据存储在磁盘上。每列都存储在单独的压缩文件中。写入时，数据将附加到文件末尾。"}]},{"ID":"20230817161899-zlx06st","Type":"NodeParagraph","Properties":{"id":"20230817161899-zlx06st","updated":"20230817161899"},"Children":[{"Type":"NodeText","Data":"并发数据访问不受任何限制："},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeBackslash","Properties":{"id":""},"Children":[{"Type":"NodeBackslashContent","Data":"-","Properties":{"id":""}}]},{"Type":"NodeText","Data":" 如果同时从表中读取并在不同的查询中写入，则读取操作将抛出异常"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeBackslash","Properties":{"id":""},"Children":[{"Type":"NodeBackslashContent","Data":"-","Properties":{"id":""}}]},{"Type":"NodeText","Data":" 如果同时写入多个查询中的表，则数据将被破坏。"}]},{"ID":"20230817161900-8mkpgw1","Type":"NodeParagraph","Properties":{"id":"20230817161900-8mkpgw1","updated":"20230817161900"},"Children":[{"Type":"NodeText","Data":"这种表引擎的典型用法是 write-once：首先只写入一次数据，然后根据需要多次读取。查询在单个流中执行。换句话说，此引擎适用于相对较小的表（建议最多1,000,000行）。如果您有许多小表，则使用此表引擎是适合的，因为它比Log引擎更简单（需要打开的文件更少）。当您拥有大量小表时，可能会导致性能低下，但在可能已经在其它 DBMS 时使用过，则您可能会发现切换使用 TinyLog 类型的表更容易。"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"不支持索引"},{"Type":"NodeText","Data":"。"}]},{"ID":"20230817161901-v63o8hz","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20230817161901-v63o8hz","updated":"20230817161901"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"# ","Properties":{"id":""}},{"Type":"NodeText","Data":"StripeLog"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://clickhouse.com/docs/zh/engines/table-engines/log-family/stripelog/#stripelog","TextMarkTextContent":" "}]},{"ID":"20230817161902-akpk08r","Type":"NodeParagraph","Properties":{"id":"20230817161902-akpk08r","updated":"20230817161902"},"Children":[{"Type":"NodeText","Data":"该引擎属于日志引擎系列。请在"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://clickhouse.com/docs/zh/engines/table-engines/log-family/","TextMarkTextContent":"日志引擎系列"},{"Type":"NodeText","Data":"文章中查看引擎的共同属性和差异。"}]},{"ID":"20230817161903-zqenyp9","Type":"NodeParagraph","Properties":{"id":"20230817161903-zqenyp9","updated":"20230817161903"},"Children":[{"Type":"NodeText","Data":"在你需要写入许多小数据量（小于一百万行）的表的场景下使用这个引擎。"}]},{"ID":"20230817161904-alhgu0f","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20230817161904-alhgu0f","updated":"20230817161904"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"建表"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://clickhouse.com/docs/zh/engines/table-engines/log-family/stripelog/#table_engines-stripelog-creating-a-table","TextMarkTextContent":" "}]},{"ID":"20230817161905-8z6ksja","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230817161905-8z6ksja","updated":"20230817161905"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"CREATE TABLE [IF NOT EXISTS] [db.]table_name [ON CLUSTER cluster]\n(\n    column1_name [type1] [DEFAULT|MATERIALIZED|ALIAS expr1],\n    column2_name [type2] [DEFAULT|MATERIALIZED|ALIAS expr2],\n    ...\n) ENGINE = StripeLog\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230817161906-xr47qhy","Type":"NodeParagraph","Properties":{"id":"20230817161906-xr47qhy","updated":"20230817161906"},"Children":[{"Type":"NodeText","Data":"查看"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://clickhouse.com/docs/zh/engines/table-engines/log-family/stripelog/#create-table-query","TextMarkTextContent":"建表"},{"Type":"NodeText","Data":"请求的详细说明。"}]},{"ID":"20230817161907-kqqdzlr","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20230817161907-kqqdzlr","updated":"20230817161907"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"写数据"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://clickhouse.com/docs/zh/engines/table-engines/log-family/stripelog/#table_engines-stripelog-writing-the-data","TextMarkTextContent":" "}]},{"ID":"20230817161908-qyh369y","Type":"NodeParagraph","Properties":{"id":"20230817161908-qyh369y","updated":"20230817161908"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"StripeLog"},{"Type":"NodeText","Data":" 引擎将所有列存储在一个文件中。对每一次 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"Insert"},{"Type":"NodeText","Data":" 请求，ClickHouse 将数据块追加在表文件的末尾，逐列写入。"}]},{"ID":"20230817161909-cbnx4es","Type":"NodeParagraph","Properties":{"id":"20230817161909-cbnx4es","updated":"20230817161909"},"Children":[{"Type":"NodeText","Data":"ClickHouse 为每张表写入以下文件："}]},{"ID":"20230817161910-prvpi1s","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161910-prvpi1s","updated":"20230817161910"},"Children":[{"ID":"20230817161911-efszz9o","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161911-efszz9o","updated":"20230817161911"},"Children":[{"ID":"20230817161912-aku1jmp","Type":"NodeParagraph","Properties":{"id":"20230817161912-aku1jmp","updated":"20230817161912"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"data.bin"},{"Type":"NodeText","Data":" — 数据文件。"}]}]},{"ID":"20230817161913-mo3woql","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161913-mo3woql","updated":"20230817161913"},"Children":[{"ID":"20230817161914-azeflu2","Type":"NodeParagraph","Properties":{"id":"20230817161914-azeflu2","updated":"20230817161914"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"index.mrk"},{"Type":"NodeText","Data":" — 带标记的文件。标记包含了已插入的每个数据块中每列的偏移量。"}]}]}]},{"ID":"20230817161915-pqai5rq","Type":"NodeParagraph","Properties":{"id":"20230817161915-pqai5rq","updated":"20230817161915"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"StripeLog"},{"Type":"NodeText","Data":" 引擎不支持 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"ALTER UPDATE"},{"Type":"NodeText","Data":" 和 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"ALTER DELETE"},{"Type":"NodeText","Data":" 操作。"}]},{"ID":"20230817161916-5jc8u9x","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20230817161916-5jc8u9x","updated":"20230817161916"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"读数据"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://clickhouse.com/docs/zh/engines/table-engines/log-family/stripelog/#table_engines-stripelog-reading-the-data","TextMarkTextContent":" "}]},{"ID":"20230817161917-f2e2vlt","Type":"NodeParagraph","Properties":{"id":"20230817161917-f2e2vlt","updated":"20230817161917"},"Children":[{"Type":"NodeText","Data":"带标记的文件使得 ClickHouse 可以并行的读取数据。这意味着 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"SELECT"},{"Type":"NodeText","Data":" 请求返回行的顺序是不可预测的。使用 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"ORDER BY"},{"Type":"NodeText","Data":" 子句对行进行排序。"}]},{"ID":"20230817161918-lo1yq0m","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20230817161918-lo1yq0m","updated":"20230817161918"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"使用示例"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://clickhouse.com/docs/zh/engines/table-engines/log-family/stripelog/#table_engines-stripelog-example-of-use","TextMarkTextContent":" "}]},{"ID":"20230817161919-hwp8rw4","Type":"NodeParagraph","Properties":{"id":"20230817161919-hwp8rw4","updated":"20230817161919"},"Children":[{"Type":"NodeText","Data":"建表："}]},{"ID":"20230817161920-2jdcgd6","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230817161920-2jdcgd6","updated":"20230817161920"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"CREATE TABLE stripe_log_table\n(\n    timestamp DateTime,\n    message_type String,\n    message String\n)\nENGINE = StripeLog\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230817161921-u6761zl","Type":"NodeParagraph","Properties":{"id":"20230817161921-u6761zl","updated":"20230817161921"},"Children":[{"Type":"NodeText","Data":"插入数据："}]},{"ID":"20230817161922-gul3hj1","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230817161922-gul3hj1","updated":"20230817161922"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"INSERT INTO stripe_log_table VALUES (now(),'REGULAR','The first regular message')\nINSERT INTO stripe_log_table VALUES (now(),'REGULAR','The second regular message'),(now(),'WARNING','The first warning message')\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230817161923-op2sxb4","Type":"NodeParagraph","Properties":{"id":"20230817161923-op2sxb4","updated":"20230817161923"},"Children":[{"Type":"NodeText","Data":"我们使用两次 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"INSERT"},{"Type":"NodeText","Data":" 请求从而在 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"data.bin"},{"Type":"NodeText","Data":" 文件中创建两个数据块。"}]},{"ID":"20230817161924-4ib30zl","Type":"NodeParagraph","Properties":{"id":"20230817161924-4ib30zl","updated":"20230817161924"},"Children":[{"Type":"NodeText","Data":"ClickHouse 在查询数据时使用多线程。每个线程读取单独的数据块并在完成后独立的返回结果行。这样的结果是，大多数情况下，输出中块的顺序和输入时相应块的顺序是不同的。例如："}]},{"ID":"20230817161925-jxtsbth","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230817161925-jxtsbth","updated":"20230817161925"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"SELECT * FROM stripe_log_table\n┌───────────timestamp─┬─message_type─┬─message────────────────────┐\n│ 2019-01-18 14:27:32 │ REGULAR      │ The second regular message │\n│ 2019-01-18 14:34:53 │ WARNING      │ The first warning message  │\n└─────────────────────┴──────────────┴────────────────────────────┘\n┌───────────timestamp─┬─message_type─┬─message───────────────────┐\n│ 2019-01-18 14:23:43 │ REGULAR      │ The first regular message │\n└─────────────────────┴──────────────┴───────────────────────────┘\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230817161926-27c582u","Type":"NodeParagraph","Properties":{"id":"20230817161926-27c582u","updated":"20230817161926"},"Children":[{"Type":"NodeText","Data":"对结果排序（默认增序）："}]},{"ID":"20230817161927-tnamula","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230817161927-tnamula","updated":"20230817161927"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"SELECT * FROM stripe_log_table ORDER BY timestamp\n┌───────────timestamp─┬─message_type─┬─message────────────────────┐\n│ 2019-01-18 14:23:43 │ REGULAR      │ The first regular message  │\n│ 2019-01-18 14:27:32 │ REGULAR      │ The second regular message │\n│ 2019-01-18 14:34:53 │ WARNING      │ The first warning message  │\n└─────────────────────┴──────────────┴────────────────────────────┘\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230817161928-8f6alv7","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20230817161928-8f6alv7","updated":"20230817161928"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"# ","Properties":{"id":""}},{"Type":"NodeText","Data":"Log"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://clickhouse.com/docs/zh/engines/table-engines/log-family/log/#log","TextMarkTextContent":" "}]},{"ID":"20230817161929-518elqp","Type":"NodeParagraph","Properties":{"id":"20230817161929-518elqp","updated":"20230817161929"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"Log"},{"Type":"NodeText","Data":" 与 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"TinyLog"},{"Type":"NodeText","Data":" 的不同之处在于，«标记» 的小文件与列文件存在一起。这些标记写在每个数据块上，并且包含偏移量，这些偏移量指示从哪里开始读取文件以便跳过指定的行数。这使得可以在多个线程中读取表数据。对于并发数据访问，可以同时执行读取操作，而写入操作则阻塞读取和其它写入。"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"Log"},{"Type":"NodeText","Data":"引擎不支持索引。同样，如果写入表失败，则该表将被破坏，并且从该表读取将返回错误。"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"Log"},{"Type":"NodeText","Data":"引擎适用于临时数据，write-once 表以及测试或演示目的。"}]}]}