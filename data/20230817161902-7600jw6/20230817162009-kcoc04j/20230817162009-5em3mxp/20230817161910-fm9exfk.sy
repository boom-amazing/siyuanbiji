{"ID":"20230817161910-fm9exfk","Spec":"1","Type":"NodeDocument","Properties":{"id":"20230817161910-fm9exfk","title":"window窗口","updated":"20230817161910"},"Children":[{"ID":"20230817161911-w90nlzb","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230817161911-w90nlzb","updated":"20230817161911"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"window窗口"}]},{"ID":"20230817161912-c3qp06p","Type":"NodeParagraph","Properties":{"id":"20230817161912-c3qp06p","updated":"20230817161912"},"Children":[{"Type":"NodeText","Data":"窗口分类：基于key和不基于key"}]},{"ID":"20230817161913-mlq72px","Type":"NodeParagraph","Properties":{"id":"20230817161913-mlq72px","updated":"20230817161913"},"Children":[{"Type":"NodeText","Data":"假设时间为5秒 三种任务分配器的区别"}]},{"ID":"20230817161914-qq59lnl","Type":"NodeParagraph","Properties":{"id":"20230817161914-qq59lnl","updated":"20230817161914"},"Children":[{"Type":"NodeText","Data":"任务分配器：滑动窗口(每五秒划分一个窗口)"}]},{"ID":"20230817161915-yzntj1k","Type":"NodeParagraph","Properties":{"id":"20230817161915-yzntj1k","updated":"20230817161915"},"Children":[{"Type":"NodeText","Data":"滚动窗口(如果滚动时间1s\u003c 窗口划分时间5s 就是每隔1s统计前五秒的数据 会有重叠 如果滚动事件大于了滑动时间那么就有空隙)"}]},{"ID":"20230817161916-7phvvsl","Type":"NodeParagraph","Properties":{"id":"20230817161916-7phvvsl","updated":"20230817161916"},"Children":[{"Type":"NodeText","Data":"会话窗口(超过了5秒 就会划分一个新的窗口 如果没有超过 就会滑到一个窗口里)"}]},{"ID":"20230817161917-w6bl8nr","Type":"NodeParagraph","Properties":{"id":"20230817161917-w6bl8nr","updated":"20230817161917"},"Children":[{"Type":"NodeText","Data":"分配策略：基于时间 基于数量。。。"}]},{"ID":"20230817161918-spjh7se","Type":"NodeParagraph","Properties":{"id":"20230817161918-spjh7se","updated":"20230817161918"},"Children":[{"Type":"NodeText","Data":"WindowFunction：reducefunction  aggregatefunction processfunction"}]},{"ID":"20230817161919-1g5vkef","Type":"NodeParagraph","Properties":{"id":"20230817161919-1g5vkef","updated":"20230817161919"},"Children":[{"Type":"NodeText","Data":"window是一种可以把无界数据切割成有界数据块的手段"}]},{"ID":"20230817161920-wr463li","Type":"NodeParagraph","Properties":{"id":"20230817161920-wr463li","updated":"20230817161920"},"Children":[{"Type":"NodeText","Data":"window分为两种 一种是timewindow 即以时间为驱动 另一种是countwindow 即以数据驱动"}]},{"ID":"20230817161921-c7fmygs","Type":"NodeParagraph","Properties":{"id":"20230817161921-c7fmygs","updated":"20230817161921"},"Children":[{"Type":"NodeText","Data":"而window又细分为滚动窗口(数据无重叠) 和滑动窗口（数据重叠）"}]},{"ID":"20230817161922-6z91evs","Type":"NodeParagraph","Properties":{"id":"20230817161922-6z91evs","updated":"20230817161922"},"Children":[{"Type":"NodeText","Data":"针对Window的类型关系进行一个汇总"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeLinkText","Data":"图片描述","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"https://img.mukewang.com/wiki/5f86b63d09d2301513070819.jpg","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20230817161923-p7cpa5b","Type":"NodeParagraph","Properties":{"id":"20230817161923-p7cpa5b","updated":"20230817161923"},"Children":[{"Type":"NodeText","Data":"Timewindon的两种用法："}]},{"ID":"20230817161924-4beqj2x","Type":"NodeParagraph","Properties":{"id":"20230817161924-4beqj2x","updated":"20230817161924"},"Children":[{"Type":"NodeText","Data":"timeWindow(Time.seconds(5)):表示每个五秒计算一次五秒内的总数"}]},{"ID":"20230817161925-l7e0jqn","Type":"NodeParagraph","Properties":{"id":"20230817161925-l7e0jqn","updated":"20230817161925"},"Children":[{"Type":"NodeText","Data":"timeWindow(Time.seconds(10),Time.seconds(5))：窗口大小为10 每隔五秒 对前十秒的数据进行汇总"}]},{"ID":"20230817161926-3xcp2gk","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"c2NhbGE=","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230817161926-3xcp2gk","updated":"20230817161926"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c2NhbGE=","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"package com.pyy.flink.window\n\nimport org.apache.flink.streaming.api.scala.StreamExecutionEnvironment\nimport org.apache.flink.streaming.api.windowing.time.Time\n\nobject TimeWindowOpScala {\n  def main(args: Array[String]): Unit = {\n    val env = StreamExecutionEnvironment.getExecutionEnvironment\n    val source = env.socketTextStream(\"bigdata04\", 9001)\n    import org.apache.flink.api.scala._\n    //滚动窗口\n//    source.flatMap(_.split(\" \"))\n//      .map((_,1))\n//      .keyBy(tup=\u003etup._1)\n//      .timeWindow(Time.seconds(5))\n//      .sum(1)\n//      .print()\n  //滑动窗口\n    source.flatMap(_.split(\" \"))\n      .map((_,1))\n      .keyBy(tup=\u003etup._1)\n      .timeWindow(Time.seconds(10),Time.seconds(5))\n      .sum(1)\n      .print()\n     env.execute(\"TimeWindowOpScala\")\n  }\n}\n\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230817161927-scfvrz5","Type":"NodeParagraph","Properties":{"id":"20230817161927-scfvrz5","updated":"20230817161927"},"Children":[{"Type":"NodeText","Data":"countwindow(5) 根据窗口内数字的大小计数"}]},{"ID":"20230817161928-rol0r5z","Type":"NodeParagraph","Properties":{"id":"20230817161928-rol0r5z","updated":"20230817161928"},"Children":[{"Type":"NodeText","Data":"countwindow(5,1)每个一个数对前五个进行计数"}]},{"ID":"20230817161929-vruooz3","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"c2NhbGE=","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230817161929-vruooz3","updated":"20230817161929"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c2NhbGE=","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"package com.pyy.flink.window\n\nimport org.apache.flink.streaming.api.scala.StreamExecutionEnvironment\nimport org.apache.flink.streaming.api.windowing.time.Time\nimport org.apache.flink.api.scala._\nimport org.apache.flink.streaming.api.windowing.assigners.WindowAssigner\nobject CountWindow {\n  def main(args: Array[String]): Unit = {\n    val env = StreamExecutionEnvironment.getExecutionEnvironment\n    val source = env.socketTextStream(\"bigdata04\", 9001)\n    //滚动窗口 每隔五个元素记一次 这里因为有分组 所以会按照分组内的元素进行计数\n//    source.flatMap(_.split(\" \"))\n//      .map((_,1))\n//      .keyBy(tup=\u003etup._1)\n//      .countWindow(5)\n//      .sum(1)\n//      .print()\n//    env.execute(\"TimeWindowOpScala\")\n//\n    //滑动窗口\n    source.flatMap(_.split(\" \"))\n      .map((_,1))\n      .keyBy(tup=\u003etup._1)\n      .countWindow(5,1)\n      .sum(1)\n      .print()\n    env.execute(\"TimeWindowOpScala\")\n  }\n}\n\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230817161930-fceoqks","Type":"NodeParagraph","Properties":{"id":"20230817161930-fceoqks","updated":"20230817161930"},"Children":[{"Type":"NodeText","Data":"window还可以再细分 分为基于key与不基于key 不基于key的window就调用windowall"}]},{"ID":"20230817161931-sbzhnmx","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230817161931-sbzhnmx","updated":"20230817161931"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"window聚合"}]},{"ID":"20230817161932-s7gql4f","Type":"NodeParagraph","Properties":{"id":"20230817161932-s7gql4f","updated":"20230817161932"},"Children":[{"Type":"NodeText","Data":"在进行Window聚合操作的时候可以分为两种，"}]},{"ID":"20230817161933-wg8i5v1","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161933-wg8i5v1","updated":"20230817161933"},"Children":[{"ID":"20230817161934-bexq6m1","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161934-bexq6m1","updated":"20230817161934"},"Children":[{"ID":"20230817161935-508jixn","Type":"NodeParagraph","Properties":{"id":"20230817161935-508jixn","updated":"20230817161935"},"Children":[{"Type":"NodeText","Data":"一种是增量聚合"}]}]},{"ID":"20230817161936-u5amq7c","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161936-u5amq7c","updated":"20230817161936"},"Children":[{"ID":"20230817161937-1oz9i87","Type":"NodeParagraph","Properties":{"id":"20230817161937-1oz9i87","updated":"20230817161937"},"Children":[{"Type":"NodeText","Data":"一种是全量聚合"}]}]}]},{"ID":"20230817161938-tf3t4t0","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230817161938-tf3t4t0","updated":"20230817161938"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"Window聚合之增量聚合"}]},{"ID":"20230817161939-3gupkzg","Type":"NodeParagraph","Properties":{"id":"20230817161939-3gupkzg","updated":"20230817161939"},"Children":[{"Type":"NodeText","Data":"增量聚合：窗口中每进入一条数据，就进行一次计算"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"常见的一些增量聚合函数如下："},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"reduce()、aggregate()、sum()、min()、max()"}]},{"ID":"20230817161940-093h1fw","Type":"NodeParagraph","Properties":{"id":"20230817161940-093h1fw","updated":"20230817161940"},"Children":[{"Type":"NodeText","Data":"下面我们来看一个增量聚合的例子，累加求和，对 8 、12、7、10这四条数据进行累加求和"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"第一次进来一条数据8，则立刻进行累加求和，结果为8。"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"第二次进来一条数据12，则立刻进行累加求和，结果为20。"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"第三次进来一条数据7，则立刻进行累加求和，结果为27。"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"第四次进来一条数据10，则立刻进行累加求和，结果为37。"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeLinkText","Data":"图片描述","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"https://img.mukewang.com/wiki/5f86b85509912cc612350567.jpg","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20230817161941-opof562","Type":"NodeParagraph","Properties":{"id":"20230817161941-opof562","updated":"20230817161941"},"Children":[{"Type":"NodeText","Data":"再来看一下Reduce函数的使用"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeLinkText","Data":"图片描述","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"https://img.mukewang.com/wiki/5f86b861095ca34a13810336.jpg","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"从这里面可以看出来reduce是每次获取一条数据，和上一次的执行结果求和，也就是来一条数据立刻计算一次。"}]},{"ID":"20230817161942-fv5jrp6","Type":"NodeParagraph","Properties":{"id":"20230817161942-fv5jrp6","updated":"20230817161942"},"Children":[{"Type":"NodeText","Data":"这就是增量聚合。"}]},{"ID":"20230817161943-uxb5k26","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230817161943-uxb5k26","updated":"20230817161943"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"Window聚合之全量聚合"}]},{"ID":"20230817161944-ze0pw7v","Type":"NodeParagraph","Properties":{"id":"20230817161944-ze0pw7v","updated":"20230817161944"},"Children":[{"Type":"NodeText","Data":"全量聚合：等属于窗口的数据到齐，才开始进行聚合计算【可以实现对窗口内的数据进行排序等需求】"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"常见的一些全量聚合函数为apply(windowFunction)和process(processWindowFunction)"}]},{"ID":"20230817161945-wf9pcoo","Type":"NodeBlockquote","Properties":{"id":"20230817161945-wf9pcoo","updated":"20230817161945"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e ","Properties":{"id":""}},{"ID":"20230817161946-9oc3u21","Type":"NodeParagraph","Properties":{"id":"20230817161946-9oc3u21","updated":"20230817161946"},"Children":[{"Type":"NodeText","Data":"注意：processWindowFunction比windowFunction提供了更多的Context(上下文)信息。"}]}]},{"ID":"20230817161947-oh6ay32","Type":"NodeParagraph","Properties":{"id":"20230817161947-oh6ay32","updated":"20230817161947"},"Children":[{"Type":"NodeText","Data":"下面我们来看一个全量聚合的例子，求最大值，对8 、12、7、10这四条数据求最大值"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"第一次进来一条数据8。"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"第二次进来一条数据12。"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"第三次进来一条数据7。"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"第四次进来一条数据10，此时窗口触发，才会对窗口内的数据进行排序，获取最大值。"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeLinkText","Data":"图片描述","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"https://img.mukewang.com/wiki/5f86b87c09f37f1912210554.jpg","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20230817161948-b5drlra","Type":"NodeParagraph","Properties":{"id":"20230817161948-b5drlra","updated":"20230817161948"},"Children":[{"Type":"NodeText","Data":"下面来看一下apply函数的使用"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeLinkText","Data":"图片描述","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"https://img.mukewang.com/wiki/5f86b88909717b4d17070781.jpg","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20230817161949-3mkyqjk","Type":"NodeParagraph","Properties":{"id":"20230817161949-3mkyqjk","updated":"20230817161949"},"Children":[{"Type":"NodeText","Data":"还有process的使用"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeLinkText","Data":"图片描述","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"https://img.mukewang.com/wiki/5f86b89409b5a1f217110662.jpg","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"在这我们会发现，这些全量聚合的函数获取到的输入数据是一个Iterable，里面是包含多条数据的，从这可以看出来，这两个函数是一次性获取一个窗口内的所有数据进行计算的。"}]},{"ID":"20230817161950-92tm1q9","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20230817161950-92tm1q9","updated":"20230817161950"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"Time"}]},{"ID":"20230817161951-nxvs4es","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230817161951-nxvs4es","updated":"20230817161951"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"Time"}]},{"ID":"20230817161952-toctuex","Type":"NodeParagraph","Properties":{"id":"20230817161952-toctuex","updated":"20230817161952"},"Children":[{"Type":"NodeText","Data":"针对流数据中的Time(时间)，可以分为以下3种。"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"Event Time：事件产生的时间，它通常由事件中的时间戳描述。"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"Ingestion time：事件进入Flink的时间。"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"Processing Time：事件被处理时当前系统的时间"}]},{"ID":"20230817161953-zn7kj22","Type":"NodeParagraph","Properties":{"id":"20230817161953-zn7kj22","updated":"20230817161953"},"Children":[{"Type":"NodeText","Data":"这几种时间的对应关系通过这个图可以很清晰的看出来"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeLinkText","Data":"图片描述","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"https://img.mukewang.com/wiki/5f86b8a9098c96dd14180678.jpg","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20230817161954-rsbu3dm","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230817161954-rsbu3dm","updated":"20230817161954"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"Time案例分析"}]},{"ID":"20230817161955-l5jr8i1","Type":"NodeParagraph","Properties":{"id":"20230817161955-l5jr8i1","updated":"20230817161955"},"Children":[{"Type":"NodeText","Data":"举个例子："}]},{"ID":"20230817161956-woivts1","Type":"NodeBlockquote","Properties":{"id":"20230817161956-woivts1","updated":"20230817161956"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e ","Properties":{"id":""}},{"ID":"20230817161957-8vk1aph","Type":"NodeParagraph","Properties":{"id":"20230817161957-8vk1aph","updated":"20230817161957"},"Children":[{"Type":"NodeText","Data":"原始日志是这样的：2026-01-01 10:00:01 INFO executor.Executor: Finished task in state 0.0"}]}]},{"ID":"20230817161958-bkxttah","Type":"NodeParagraph","Properties":{"id":"20230817161958-bkxttah","updated":"20230817161958"},"Children":[{"Type":"NodeText","Data":"2026-01-01 10:00:01是日志数据产生的时间"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"日志数据进入Flink的时间是：2026-01-01 20:00:01"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"日志数据到达Window处理的时间是：2026-01-01 20:00:02"}]},{"ID":"20230817161959-3irqqgy","Type":"NodeBlockquote","Properties":{"id":"20230817161959-3irqqgy","updated":"20230817161959"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e ","Properties":{"id":""}},{"ID":"20230817161960-y8npy95","Type":"NodeParagraph","Properties":{"id":"20230817161960-y8npy95","updated":"20230817161960"},"Children":[{"Type":"NodeText","Data":"如果我们想要统计每分钟内接口调用失败的错误日志个数，使用哪个时间才有意义？"}]}]},{"ID":"20230817161961-fjksndw","Type":"NodeParagraph","Properties":{"id":"20230817161961-fjksndw","updated":"20230817161961"},"Children":[{"Type":"NodeText","Data":"因为数据有可能会出现延迟，如果使用 数据进入Flink的时间 或者 Window处理的时间，其实是没有意义的，这个时候需要使用原始日志中的时间才是有意义的，这个才是数据产生的时间。"}]},{"ID":"20230817161962-ips50v6","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230817161962-ips50v6","updated":"20230817161962"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"Time类型设置"}]},{"ID":"20230817161963-3z46357","Type":"NodeParagraph","Properties":{"id":"20230817161963-3z46357","updated":"20230817161963"},"Children":[{"Type":"NodeText","Data":"那我们在Flink的流处理中，默认使用的是哪个时间呢？"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"默认情况下Flink在流处理中使用的时间是ProcessingTime"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"查看源码：在类StreamExecutionEnvironment中"}]},{"ID":"20230817161964-mdc5ad1","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230817161964-mdc5ad1","updated":"20230817161964"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"private static final TimeCharacteristic DEFAULT_TIME_CHARACTERISTIC = TimeCharacteristic.ProcessingTime;\n代码块1\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230817161965-58u68z0","Type":"NodeParagraph","Properties":{"id":"20230817161965-58u68z0","updated":"20230817161965"},"Children":[{"Type":"NodeText","Data":"如何修改呢？"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"想要修改的话可以使用setStreamTimeCharacteristic(…)"}]},{"ID":"20230817161966-m2sawb6","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230817161966-m2sawb6","updated":"20230817161966"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"env.setStreamTimeCharacteristic(TimeCharacteristic.EventTime)\n代码块1\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230817161967-0a60gvj","Type":"NodeParagraph","Properties":{"id":"20230817161967-0a60gvj","updated":"20230817161967"},"Children":[{"Type":"NodeText","Data":"或者"}]},{"ID":"20230817161968-erqj3ho","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230817161968-erqj3ho","updated":"20230817161968"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"env.setStreamTimeCharacteristic(TimeCharacteristic.IngestionTime)\n代码块预览复制1\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230817161969-rmjmwgd","Type":"NodeParagraph","Properties":{"id":"20230817161969-rmjmwgd","updated":"20230817161969"}}]}