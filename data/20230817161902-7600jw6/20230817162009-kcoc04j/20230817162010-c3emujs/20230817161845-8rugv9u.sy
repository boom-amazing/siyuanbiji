{"ID":"20230817161845-8rugv9u","Spec":"1","Type":"NodeDocument","Properties":{"id":"20230817161845-8rugv9u","title":"kafka的基本使用","updated":"20230817161845"},"Children":[{"ID":"20230817161846-mur0tar","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230817161846-mur0tar","updated":"20230817161846"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"kafka的集群搭建使用"}]},{"ID":"20230817161847-1vz4jz4","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20230817161847-1vz4jz4","updated":"20230817161847"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"##### ","Properties":{"id":""}},{"Type":"NodeText","Data":"kafak线上集群部署方案"}]},{"ID":"20230817161848-wuqjajc","Type":"NodeParagraph","Properties":{"id":"20230817161848-wuqjajc","updated":"20230817161848"},"Children":[{"Type":"NodeText","Data":"从操作系统、磁盘、磁盘容量、带宽考虑"}]},{"ID":"20230817161849-rjyrcpb","Type":"NodeParagraph","Properties":{"id":"20230817161849-rjyrcpb","updated":"20230817161849"},"Children":[{"Type":"NodeText","Data":"1、操作系统尽量利用I/O模型考虑 建议将kafak部署到Linux上"}]},{"ID":"20230817161850-1qa3e8p","Type":"NodeParagraph","Properties":{"id":"20230817161850-1qa3e8p","updated":"20230817161850"},"Children":[{"Type":"NodeText","Data":"2、磁盘从磁盘的IO性能考虑 普通环境使用机械磁盘 不需要搭建RAID"}]},{"ID":"20230817161851-n9xbokz","Type":"NodeParagraph","Properties":{"id":"20230817161851-n9xbokz","updated":"20230817161851"},"Children":[{"Type":"NodeText","Data":"3、磁盘容量 根据消息的留存数、留存时间、平均消息大小、备份数以及是否启动压缩来综合考虑"}]},{"ID":"20230817161852-y1gpar1","Type":"NodeParagraph","Properties":{"id":"20230817161852-y1gpar1","updated":"20230817161852"},"Children":[{"Type":"NodeText","Data":"实际工作加以预留%20 -%30的空间"}]},{"ID":"20230817161853-m7lajd9","Type":"NodeParagraph","Properties":{"id":"20230817161853-m7lajd9","updated":"20230817161853"},"Children":[{"Type":"NodeText","Data":"假设你所在公司有个业务每天需要向 Kafka 集群发送 1 亿条消息，每条消息保存两份以防止数据丢失，另外消息默认保存两周时间。现在假设消息的平均大小是 1KB，那么你能说出你的 Kafka 集群需要为这个业务预留多少磁盘空间吗？"}]},{"ID":"20230817161854-06yhm9t","Type":"NodeParagraph","Properties":{"id":"20230817161854-06yhm9t","updated":"20230817161854"},"Children":[{"Type":"NodeText","Data":"我们来计算一下：每天 1 亿条 1KB 大小的消息，保存两份且留存两周的时间，那么总的空间大小就等于 1 亿 * 1KB * 2 / 1000 / 1000 = 200GB。一般情况下 Kafka 集群除了消息数据还有其他类型的数据，比如索引数据等，故我们再为这些数据预留出 10% 的磁盘空间，因此总的存储容量就是 220GB。既然要保存两周，那么整体容量即为 220GB * 14，大约 3TB 左右。Kafka 支持数据的压缩，假设压缩比是 0.75，那么最后你需要规划的存储空间就是 0.75 * 3 = 2.25TB。"}]},{"ID":"20230817161855-x1ihovv","Type":"NodeParagraph","Properties":{"id":"20230817161855-x1ihovv","updated":"20230817161855"},"Children":[{"Type":"NodeText","Data":"4、带宽 根据实际带宽资源和业务SLA预估服务器数量  对于千兆网络 建议每台服务器按照700Mbs来计算 避免大量丢包"}]},{"ID":"20230817161856-k5nff7z","Type":"NodeParagraph","Properties":{"id":"20230817161856-k5nff7z","updated":"20230817161856"},"Children":[{"Type":"NodeText","Data":"现在你有个业务，其业务目标或 SLA 是在 1 小时内处理 1TB 的业务数据。那么问题来了，你到底需要多少台 Kafka 服务器来完成这个业务呢？"}]},{"ID":"20230817161857-q1oc1bu","Type":"NodeParagraph","Properties":{"id":"20230817161857-q1oc1bu","updated":"20230817161857"},"Children":[{"Type":"NodeText","Data":"让我们来计算一下，由于带宽是 1Gbps，即每秒处理 1Gb 的数据，假设每台 Kafka 服务器都是安装在专属的机器上，也就是说每台 Kafka 机器上没有混布其他服务，毕竟真实环境中不建议这么做。通常情况下你只能假设 Kafka 会用到 70% 的带宽资源，因为总要为其他应用或进程留一些资源。根据实际使用经验，超过 70% 的阈值就有网络丢包的可能性了，故 70% 的设定是一个比较合理的值，也就是说单台 Kafka 服务器最多也就能使用大约 700Mb 的带宽资源。稍等，这只是它能使用的最大带宽资源，你不能让 Kafka 服务器常规性使用这么多资源，故通常要再额外预留出 2/3 的资源，即单台服务器使用带宽 700Mb / 3 ≈ 240Mbps。需要提示的是，这里的 2/3 其实是相当保守的，你可以结合你自己机器的使用情况酌情减少此值。好了，有了 240Mbps，我们就可以计算 1 小时内处理 1TB 数据所需的服务器数量了。根据这个目标，我们每秒需要处理 2336Mb 的数据，除以 240，约等于 10 台服务器。如果消息还需要额外复制两份，那么总的服务器台数还要乘以 3，即 30 台"}]},{"ID":"20230817161858-tskohct","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20230817161858-tskohct","updated":"20230817161858"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"##### ","Properties":{"id":""}},{"Type":"NodeText","Data":"kafak的最重要的集群参数配置"}]},{"ID":"20230817161859-x11q5k2","Type":"NodeHeading","HeadingLevel":6,"Properties":{"id":"20230817161859-x11q5k2","updated":"20230817161859"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"###### ","Properties":{"id":""}},{"Type":"NodeText","Data":"1、broker端参数 即静态参数 以下四个参数配置都是在server.properties中配置的"}]},{"ID":"20230817161860-297rdnn","Type":"NodeParagraph","Properties":{"id":"20230817161860-297rdnn","updated":"20230817161860"},"Children":[{"Type":"NodeText","Data":"首先 Broker 是需要配置存储信息的，即 Broker 使用哪些磁盘。那么针对存储信息的重要参数有以下这么几个："}]},{"ID":"20230817161861-rcgqu09","Type":"NodeList","ListData":{"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161861-rcgqu09","updated":"20230817161861"},"Children":[{"ID":"20230817161862-4mfrmcx","Type":"NodeListItem","Data":"-","ListData":{"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161862-4mfrmcx","updated":"20230817161862"},"Children":[{"ID":"20230817161863-y5nxnfd","Type":"NodeParagraph","Properties":{"id":"20230817161863-y5nxnfd","updated":"20230817161863"},"Children":[{"Type":"NodeText","Data":"log.dirs：这是非常重要的参数，指定了 Broker 需要使用的若干个文件目录路径。要知道这个参数是没有默认值的，这说明什么？这说明它必须由你亲自指定。"}]}]},{"ID":"20230817161864-k9t7a4u","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161864-k9t7a4u","updated":"20230817161864"},"Children":[{"ID":"20230817161865-2jviait","Type":"NodeParagraph","Properties":{"id":"20230817161865-2jviait","updated":"20230817161865"},"Children":[{"Type":"NodeText","Data":"log.dir：注意这是 dir，结尾没有 s，说明它只能表示单个路径，它是补充上一个参数用的。"}]}]}]},{"ID":"20230817161866-2f9ggq6","Type":"NodeParagraph","Properties":{"id":"20230817161866-2f9ggq6","updated":"20230817161866"},"Children":[{"Type":"NodeText","Data":"这两个参数应该怎么设置呢？很简单，你只要设置log.dirs，即第一个参数就好了，不要设置log.dir。而且更重要的是，在线上生产环境中一定要为log.dirs配置多个路径，具体格式是一个 CSV 格式，也就是用逗号分隔的多个路径，比如/home/kafka1,/home/kafka2,/home/kafka3这样。"}]},{"ID":"20230817161867-i17ftj1","Type":"NodeParagraph","Properties":{"id":"20230817161867-i17ftj1","updated":"20230817161867"},"Children":[{"Type":"NodeText","Data":"如果有条件的话你最好保证这些目录挂载到不同的物理磁盘上。这样做有两个好处："}]},{"ID":"20230817161868-cby0f72","Type":"NodeList","ListData":{"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161868-cby0f72","updated":"20230817161868"},"Children":[{"ID":"20230817161869-xxyi4ui","Type":"NodeListItem","Data":"-","ListData":{"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161869-xxyi4ui","updated":"20230817161869"},"Children":[{"ID":"20230817161870-ni0pidm","Type":"NodeParagraph","Properties":{"id":"20230817161870-ni0pidm","updated":"20230817161870"},"Children":[{"Type":"NodeText","Data":"提升读写性能：比起单块磁盘，多块物理磁盘同时读写数据有更高的吞吐量。"}]}]},{"ID":"20230817161871-h2ml2k4","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161871-h2ml2k4","updated":"20230817161871"},"Children":[{"ID":"20230817161872-yqdeyoc","Type":"NodeParagraph","Properties":{"id":"20230817161872-yqdeyoc","updated":"20230817161872"},"Children":[{"Type":"NodeText","Data":"能够实现故障转移：即 Failover。这是 Kafka 1.1 版本新引入的强大功能。要知道在以前，只要 Kafka Broker 使用的任何一块磁盘挂掉了，整个 Broker 进程都会关闭。但是自 1.1 开始，这种情况被修正了，坏掉的磁盘上的数据会自动地转移到其他正常的磁盘上，而且 Broker 还能正常工作。还记得上一期我们关于 Kafka 是否需要使用 RAID 的讨论吗？这个改进正是我们舍弃 RAID 方案的基础：没有这种 Failover 的话，我们只能依靠 RAID 来提供保障。"}]}]}]},{"ID":"20230817161873-uef1gis","Type":"NodeHeading","HeadingLevel":6,"Properties":{"id":"20230817161873-uef1gis","updated":"20230817161873"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"###### ","Properties":{"id":""}},{"Type":"NodeText","Data":"2、zookeeper相关参数"}]},{"ID":"20230817161874-e2zivc6","Type":"NodeParagraph","Properties":{"id":"20230817161874-e2zivc6","updated":"20230817161874"},"Children":[{"Type":"NodeText","Data":"Kafka 与 ZooKeeper 相关的最重要的参数当属zookeeper.connect。这也是一个 CSV 格式的参数，比如我可以指定它的值为zk1:2181,zk2:2181,zk3:2181。2181 是 ZooKeeper 的默认端口。"}]},{"ID":"20230817161875-nox3xow","Type":"NodeParagraph","Properties":{"id":"20230817161875-nox3xow","updated":"20230817161875"},"Children":[{"Type":"NodeText","Data":"如果你有两套 Kafka 集群，假设分别叫它们 kafka1 和 kafka2，那么两套集群的zookeeper.connect参数可以这样指定：zk1:2181,zk2:2181,zk3:2181/kafka1和zk1:2181,zk2:2181,zk3:2181/kafka2。"}]},{"ID":"20230817161876-l665mm3","Type":"NodeHeading","HeadingLevel":6,"Properties":{"id":"20230817161876-l665mm3","updated":"20230817161876"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"###### ","Properties":{"id":""}},{"Type":"NodeText","Data":"3、broker相关参数"}]},{"ID":"20230817161877-i3t6ya3","Type":"NodeParagraph","Properties":{"id":"20230817161877-i3t6ya3","updated":"20230817161877"},"Children":[{"Type":"NodeText","Data":"就是来让broker与客户端 或者broker与broker通信的相关参数"}]},{"ID":"20230817161878-hf73qiz","Type":"NodeList","ListData":{"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161878-hf73qiz","updated":"20230817161878"},"Children":[{"ID":"20230817161879-knrxrvh","Type":"NodeListItem","Data":"-","ListData":{"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161879-knrxrvh","updated":"20230817161879"},"Children":[{"ID":"20230817161880-16wq8i3","Type":"NodeParagraph","Properties":{"id":"20230817161880-16wq8i3","updated":"20230817161880"},"Children":[{"Type":"NodeText","Data":"listeners：学名叫监听器，其实就是告诉外部连接者要通过什么协议访问指定主机名和端口开放的 Kafka 服务。"}]}]},{"ID":"20230817161881-0f6pmjo","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161881-0f6pmjo","updated":"20230817161881"},"Children":[{"ID":"20230817161882-ijvv2vb","Type":"NodeParagraph","Properties":{"id":"20230817161882-ijvv2vb","updated":"20230817161882"},"Children":[{"Type":"NodeText","Data":"advertised.listeners：和 listeners 相比多了个 advertised。Advertised 的含义表示宣称的、公布的，就是说这组监听器是 Broker 用于对外发布的。"}]}]}]},{"ID":"20230817161883-ttdhcyp","Type":"NodeParagraph","Properties":{"id":"20230817161883-ttdhcyp","updated":"20230817161883"},"Children":[{"Type":"NodeText","Data":"建议：最好全部使用主机名，即 Broker 端和 Client 端应用配置中全部填写主机名。"}]},{"ID":"20230817161884-7xokd2h","Type":"NodeHeading","HeadingLevel":6,"Properties":{"id":"20230817161884-7xokd2h","updated":"20230817161884"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"###### ","Properties":{"id":""}},{"Type":"NodeText","Data":"4、topic管理"}]},{"ID":"20230817161885-12x8yer","Type":"NodeList","ListData":{"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161885-12x8yer","updated":"20230817161885"},"Children":[{"ID":"20230817161886-y69rser","Type":"NodeListItem","Data":"-","ListData":{"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161886-y69rser","updated":"20230817161886"},"Children":[{"ID":"20230817161887-vj0bwrf","Type":"NodeParagraph","Properties":{"id":"20230817161887-vj0bwrf","updated":"20230817161887"},"Children":[{"Type":"NodeText","Data":"auto.create.topics.enable：是否允许自动创建 Topic。"}]}]},{"ID":"20230817161888-j52thbu","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161888-j52thbu","updated":"20230817161888"},"Children":[{"ID":"20230817161889-e1dsgby","Type":"NodeParagraph","Properties":{"id":"20230817161889-e1dsgby","updated":"20230817161889"},"Children":[{"Type":"NodeText","Data":"unclean.leader.election.enable：是否允许 Unclean Leader 选举。"}]}]},{"ID":"20230817161890-gbf1bqs","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161890-gbf1bqs","updated":"20230817161890"},"Children":[{"ID":"20230817161891-8v23lba","Type":"NodeParagraph","Properties":{"id":"20230817161891-8v23lba","updated":"20230817161891"},"Children":[{"Type":"NodeText","Data":"auto.leader.rebalance.enable：是否允许定期进行 Leader 选举。"}]},{"ID":"20230817161892-6n2w3u7","Type":"NodeParagraph","Properties":{"id":"20230817161892-6n2w3u7","updated":"20230817161892"},"Children":[{"Type":"NodeText","Data":"建议都设置成false"}]}]}]},{"ID":"20230817161893-vwfnl7q","Type":"NodeParagraph","Properties":{"id":"20230817161893-vwfnl7q","updated":"20230817161893"},"Children":[{"Type":"NodeText","Data":"5、数据留存"}]},{"ID":"20230817161894-gtx9m00","Type":"NodeList","ListData":{"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161894-gtx9m00","updated":"20230817161894"},"Children":[{"ID":"20230817161895-27b638j","Type":"NodeListItem","Data":"-","ListData":{"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161895-27b638j","updated":"20230817161895"},"Children":[{"ID":"20230817161896-vdd00p5","Type":"NodeParagraph","Properties":{"id":"20230817161896-vdd00p5","updated":"20230817161896"},"Children":[{"Type":"NodeText","Data":"log.retention.{hours|minutes|ms}：这是个“三兄弟”，都是控制一条消息数据被保存多长时间。从优先级上来说 ms 设置最高、minutes 次之、hours 最低。//默认是7天 如果将kafak当作存储来用 可以适当调大"}]}]},{"ID":"20230817161897-88jh9o1","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161897-88jh9o1","updated":"20230817161897"},"Children":[{"ID":"20230817161898-fc92x6l","Type":"NodeParagraph","Properties":{"id":"20230817161898-fc92x6l","updated":"20230817161898"},"Children":[{"Type":"NodeText","Data":"log.retention.bytes：这是指定 Broker 为消息保存的总磁盘容量大小。//默认是-1 即提供无限大的磁盘容量大小存储 但在云端部署 为了避免恶意租户 可以设置此参数"}]}]},{"ID":"20230817161899-k65qpnk","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161899-k65qpnk","updated":"20230817161899"},"Children":[{"ID":"20230817161900-1pnyo8u","Type":"NodeParagraph","Properties":{"id":"20230817161900-1pnyo8u","updated":"20230817161900"},"Children":[{"Type":"NodeText","Data":"message.max.bytes：控制 Broker 能够接收的最大消息大小。//默认是1000012B 花不到1MB 实际生产过程中可以适当调大"}]}]}]},{"ID":"20230817161901-s8qm510","Type":"NodeHeading","HeadingLevel":6,"Properties":{"id":"20230817161901-s8qm510","updated":"20230817161901"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"###### ","Properties":{"id":""}},{"Type":"NodeText","Data":"5、topic级别参数"}]},{"ID":"20230817161902-7esc6nj","Type":"NodeParagraph","Properties":{"id":"20230817161902-7esc6nj","updated":"20230817161902"},"Children":[{"Type":"NodeText","Data":"这些参数和全局参数不同之处在于不同部门可以根据业务来动态指定这些参数的大小"}]},{"ID":"20230817161903-ax8dy2x","Type":"NodeList","ListData":{"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161903-ax8dy2x","updated":"20230817161903"},"Children":[{"ID":"20230817161904-c68ooax","Type":"NodeListItem","Data":"-","ListData":{"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161904-c68ooax","updated":"20230817161904"},"Children":[{"ID":"20230817161905-7z4kfuj","Type":"NodeParagraph","Properties":{"id":"20230817161905-7z4kfuj","updated":"20230817161905"},"Children":[{"Type":"NodeText","Data":"retention.ms：规定了该 Topic 消息被保存的时长。默认是 7 天，即该 Topic 只保存最近 7 天的消息。一旦设置了这个值，它会覆盖掉 Broker 端的全局参数值。"}]}]},{"ID":"20230817161906-hx8sauy","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161906-hx8sauy","updated":"20230817161906"},"Children":[{"ID":"20230817161907-8vw7na5","Type":"NodeParagraph","Properties":{"id":"20230817161907-8vw7na5","updated":"20230817161907"},"Children":[{"Type":"NodeText","Data":"retention.bytes：规定了要为该 Topic 预留多大的磁盘空间。和全局参数作用相似，这个值通常在多租户的 Kafka 集群中会有用武之地。当前默认值是 -1，表示可以无限使用磁盘空间。"}]}]},{"ID":"20230817161908-45la5p2","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161908-45la5p2","updated":"20230817161908"},"Children":[{"ID":"20230817161909-n837mg9","Type":"NodeParagraph","Properties":{"id":"20230817161909-n837mg9","updated":"20230817161909"},"Children":[{"Type":"NodeText","Data":"max.message.bytes 一次处理数据的大小 可以根据业务适当调大"}]}]}]},{"ID":"20230817161910-p5vt1rb","Type":"NodeParagraph","Properties":{"id":"20230817161910-p5vt1rb","updated":"20230817161910"},"Children":[{"Type":"NodeText","Data":"topic级别的参数可以在创建topic时配置也可以在修改topic配置"}]},{"ID":"20230817161911-jgof6hv","Type":"NodeParagraph","Properties":{"id":"20230817161911-jgof6hv","updated":"20230817161911"},"Children":[{"Type":"NodeText","Data":"创建时配置"}]},{"ID":"20230817161912-2nljl94","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230817161912-2nljl94","updated":"20230817161912"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"\nbin/kafka-topics.sh --bootstrap-server localhost:9092 --create --topic transaction --partitions 1 --replication-factor 1 --config retention.ms=15552000000 --config max.message.bytes=5242880\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230817161913-902t6bm","Type":"NodeParagraph","Properties":{"id":"20230817161913-902t6bm","updated":"20230817161913"},"Children":[{"Type":"NodeText","Data":"修改时配置："}]},{"ID":"20230817161914-pix5k1u","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230817161914-pix5k1u","updated":"20230817161914"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"\nbin/kafka-configs.sh --zookeeper localhost:2181 --entity-type topics --entity-name transaction --alter --add-config max.message.bytes=10485760\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230817161915-or41yze","Type":"NodeParagraph","Properties":{"id":"20230817161915-or41yze","updated":"20230817161915"},"Children":[{"Type":"NodeText","Data":"最好是用第二种方式配置"}]},{"ID":"20230817161916-rk1srkx","Type":"NodeHeading","HeadingLevel":6,"Properties":{"id":"20230817161916-rk1srkx","updated":"20230817161916"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"###### ","Properties":{"id":""}},{"Type":"NodeText","Data":"6、JVM参数"}]},{"ID":"20230817161917-38i44lq","Type":"NodeParagraph","Properties":{"id":"20230817161917-38i44lq","updated":"20230817161917"},"Children":[{"Type":"NodeText","Data":"可以根据cpu资源是否充足来选择合适的垃圾回收器 如果cpu资源充足 建议使用cms回收器 同时建议将堆内存的大小无脑设置为6GB"}]},{"ID":"20230817161918-kxdnceb","Type":"NodeParagraph","Properties":{"id":"20230817161918-kxdnceb","updated":"20230817161918"},"Children":[{"Type":"NodeText","Data":"在kafka-server-start.sh中修改"}]},{"ID":"20230817161919-hb17oh5","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"amF2YQ==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230817161919-hb17oh5","updated":"20230817161919"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"\n$\u003e export KAFKA_HEAP_OPTS=--Xms6g  --Xmx6g\n$\u003e export KAFKA_JVM_PERFORMANCE_OPTS= -server -XX:+UseG1GC -XX:MaxGCPauseMillis=20 -XX:InitiatingHeapOccupancyPercent=35 -XX:+ExplicitGCInvokesConcurrent -Djava.awt.headless=true\n$\u003e bin/kafka-server-start.sh config/server.properties\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230817161920-asspvq7","Type":"NodeHeading","HeadingLevel":6,"Properties":{"id":"20230817161920-asspvq7","updated":"20230817161920"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"###### ","Properties":{"id":""}},{"Type":"NodeText","Data":"7、操作系统参数"}]},{"ID":"20230817161921-avbjlnz","Type":"NodeList","ListData":{"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161921-avbjlnz","updated":"20230817161921"},"Children":[{"ID":"20230817161922-ag4eb0j","Type":"NodeListItem","Data":"-","ListData":{"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161922-ag4eb0j","updated":"20230817161922"},"Children":[{"ID":"20230817161923-vdyk3uo","Type":"NodeParagraph","Properties":{"id":"20230817161923-vdyk3uo","updated":"20230817161923"},"Children":[{"Type":"NodeText","Data":"文件描述符限制 ulimit -n 1000000"}]}]},{"ID":"20230817161924-uwuy0l8","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161924-uwuy0l8","updated":"20230817161924"},"Children":[{"ID":"20230817161925-g56n11s","Type":"NodeParagraph","Properties":{"id":"20230817161925-g56n11s","updated":"20230817161925"},"Children":[{"Type":"NodeText","Data":"文件系统类型 xfs"}]}]},{"ID":"20230817161926-h1m9c0o","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161926-h1m9c0o","updated":"20230817161926"},"Children":[{"ID":"20230817161927-o9vbc9p","Type":"NodeParagraph","Properties":{"id":"20230817161927-o9vbc9p","updated":"20230817161927"},"Children":[{"Type":"NodeText","Data":"Swappiness 1"}]}]},{"ID":"20230817161928-ir27399","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161928-ir27399","updated":"20230817161928"},"Children":[{"ID":"20230817161929-83ov2nf","Type":"NodeParagraph","Properties":{"id":"20230817161929-83ov2nf","updated":"20230817161929"},"Children":[{"Type":"NodeText","Data":"提交时间  默认是5秒 可以适当调大"}]}]}]}]}