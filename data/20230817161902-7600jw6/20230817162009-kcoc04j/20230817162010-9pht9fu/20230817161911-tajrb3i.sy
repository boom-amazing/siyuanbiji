{"ID":"20230817161911-tajrb3i","Spec":"1","Type":"NodeDocument","Properties":{"id":"20230817161911-tajrb3i","title":"Flume的三大核心组件","updated":"20230817161911"},"Children":[{"ID":"20230817161912-lvtt6bs","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20230817161912-lvtt6bs","updated":"20230817161912"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"Flume"}]},{"ID":"20230817161913-ba7rorg","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20230817161913-ba7rorg","updated":"20230817161913"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"##### ","Properties":{"id":""}},{"Type":"NodeText","Data":"什么是flume？"}]},{"ID":"20230817161914-1xeq4hb","Type":"NodeParagraph","Properties":{"id":"20230817161914-1xeq4hb","updated":"20230817161914"},"Children":[{"Type":"NodeText","Data":"flume是一个高可用，高可靠，分布式的海量日志采集、聚合和传输的系统"}]},{"ID":"20230817161915-iy32i81","Type":"NodeParagraph","Properties":{"id":"20230817161915-iy32i81","updated":"20230817161915"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeLinkText","Data":"flume架构","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"C:\\Users\\HHH\\Desktop\\flume架构.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20230817161916-wcjkbv2","Type":"NodeParagraph","Properties":{"id":"20230817161916-wcjkbv2","updated":"20230817161916"},"Children":[{"Type":"NodeText","Data":"特性：1、他有一个简单、灵活的基于流的数据结构"}]},{"ID":"20230817161917-eh42mi4","Type":"NodeParagraph","Properties":{"id":"20230817161917-eh42mi4","updated":"20230817161917"},"Children":[{"Type":"NodeText","Data":"2、具有负载均衡和故障转移机制"}]},{"ID":"20230817161918-spltwop","Type":"NodeParagraph","Properties":{"id":"20230817161918-spltwop","updated":"20230817161918"},"Children":[{"Type":"NodeText","Data":"3、一个简单可扩展的数据模型"}]},{"ID":"20230817161919-yxy67qv","Type":"NodeHeading","HeadingLevel":5,"Properties":{"id":"20230817161919-yxy67qv","updated":"20230817161919"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"##### ","Properties":{"id":""}},{"Type":"NodeText","Data":"Flume高级应用场景"}]},{"ID":"20230817161920-h06utdq","Type":"NodeParagraph","Properties":{"id":"20230817161920-h06utdq","updated":"20230817161920"},"Children":[{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeLinkText","Data":"屏幕截图 2022-02-13 111334","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"C:\\Users\\HHH\\Desktop\\屏幕截图 2022-02-13 111334.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]},{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeLinkText","Data":"屏幕截图 2022-02-13 111351","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"C:\\Users\\HHH\\Desktop\\屏幕截图 2022-02-13 111351.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]}]},{"ID":"20230817161921-0ffimg0","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20230817161921-0ffimg0","updated":"20230817161921"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"Flume的三大核心组件"}]},{"ID":"20230817161922-y8bmgjk","Type":"NodeParagraph","Properties":{"id":"20230817161922-y8bmgjk","updated":"20230817161922"},"Children":[{"Type":"NodeText","Data":"Flume的三大核心组件："}]},{"ID":"20230817161923-m96x9lx","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161923-m96x9lx","updated":"20230817161923"},"Children":[{"ID":"20230817161924-bi0ox7t","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161924-bi0ox7t","updated":"20230817161924"},"Children":[{"ID":"20230817161925-tbe2x8c","Type":"NodeParagraph","Properties":{"id":"20230817161925-tbe2x8c","updated":"20230817161925"},"Children":[{"Type":"NodeText","Data":"Source：数据源"}]}]},{"ID":"20230817161926-bw4ula8","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161926-bw4ula8","updated":"20230817161926"},"Children":[{"ID":"20230817161927-y9f3ehk","Type":"NodeParagraph","Properties":{"id":"20230817161927-y9f3ehk","updated":"20230817161927"},"Children":[{"Type":"NodeText","Data":"Channel：临时存储数据的管道"}]}]},{"ID":"20230817161928-d6kkb22","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161928-d6kkb22","updated":"20230817161928"},"Children":[{"ID":"20230817161929-zflxjmr","Type":"NodeParagraph","Properties":{"id":"20230817161929-zflxjmr","updated":"20230817161929"},"Children":[{"Type":"NodeText","Data":"Sink：目的地"}]}]}]},{"ID":"20230817161930-oss1rgq","Type":"NodeParagraph","Properties":{"id":"20230817161930-oss1rgq","updated":"20230817161930"},"Children":[{"Type":"NodeText","Data":"接下来具体看一下这三大核心组件都是干什么的"}]},{"ID":"20230817161931-boxuhlp","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230817161931-boxuhlp","updated":"20230817161931"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"Source"}]},{"ID":"20230817161932-mdqlsw7","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161932-mdqlsw7","updated":"20230817161932"},"Children":[{"ID":"20230817161933-82lseei","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161933-82lseei","updated":"20230817161933"},"Children":[{"ID":"20230817161934-rsfx9gd","Type":"NodeParagraph","Properties":{"id":"20230817161934-rsfx9gd","updated":"20230817161934"},"Children":[{"Type":"NodeText","Data":"Source：数据源：通过source组件可以指定让Flume读取哪里的数据，然后将数据传递给后面的channel"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"Flume内置支持读取很多种数据源，基于文件、基于目录、基于TCP\\UDP端口、基于HTTP、Kafka的等等、当然了，如果这里面没有你喜欢的，他也是支持自定义的"}]}]}]},{"ID":"20230817161935-ft4b2hm","Type":"NodeParagraph","Properties":{"id":"20230817161935-ft4b2hm","updated":"20230817161935"},"Children":[{"Type":"NodeText","Data":"在这我们挑几个常用的看一下："}]},{"ID":"20230817161936-cdkz40n","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161936-cdkz40n","updated":"20230817161936"},"Children":[{"ID":"20230817161937-8zbwahy","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161937-8zbwahy","updated":"20230817161937"},"Children":[{"ID":"20230817161938-74hce2i","Type":"NodeParagraph","Properties":{"id":"20230817161938-74hce2i","updated":"20230817161938"},"Children":[{"Type":"NodeText","Data":"Exec Source：实现文件监控，可以实时监控文件中的新增内容，类似于linux中的tail -f 效果。"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"在这需要注意 tail -F 和 tail -f 的区别"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"tail -F"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"等同于–follow=name --retry，根据文件名进行追踪，并保持重试，即该文件被删除或改名后，如果再次创建相同的文件名，会继续追踪"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"tail -f"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"等同于–follow=descriptor，根据文件描述符进行追踪，当文件改名或被删除，追踪停止"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"在实际工作中我们的日志数据一般都会通过log4j记录，log4j产生的日志文件名称是固定的，每天定时给文件重命名"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"假设默认log4j会向access.log文件中写日志，每当凌晨0点的时候，log4j都会对文件进行重命名，在access后面添加昨天的日期，然后再创建新的access.log记录当天的新增日志数据。"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"这个时候如果想要一直监控access.log文件中的新增日志数据的话，就需要使用tail -F"}]}]},{"ID":"20230817161939-x7rhnd4","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161939-x7rhnd4","updated":"20230817161939"},"Children":[{"ID":"20230817161940-9sd4zji","Type":"NodeParagraph","Properties":{"id":"20230817161940-9sd4zji","updated":"20230817161940"},"Children":[{"Type":"NodeText","Data":"NetCat TCP/UDP Source： 采集指定端口(tcp、udp)的数据，可以读取流经端口的每一行数据"}]}]},{"ID":"20230817161941-19lrtww","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161941-19lrtww","updated":"20230817161941"},"Children":[{"ID":"20230817161942-uvl0btl","Type":"NodeParagraph","Properties":{"id":"20230817161942-uvl0btl","updated":"20230817161942"},"Children":[{"Type":"NodeText","Data":"Spooling Directory Source：采集文件夹里新增的文件"}]}]},{"ID":"20230817161943-1c9m3h5","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161943-1c9m3h5","updated":"20230817161943"},"Children":[{"ID":"20230817161944-hp696lv","Type":"NodeParagraph","Properties":{"id":"20230817161944-hp696lv","updated":"20230817161944"},"Children":[{"Type":"NodeText","Data":"Kafka Source：从Kafka消息队列中采集数据"}]}]}]},{"ID":"20230817161945-sg9e59p","Type":"NodeBlockquote","Properties":{"id":"20230817161945-sg9e59p","updated":"20230817161945"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e ","Properties":{"id":""}},{"ID":"20230817161946-b4zr6tv","Type":"NodeParagraph","Properties":{"id":"20230817161946-b4zr6tv","updated":"20230817161946"},"Children":[{"Type":"NodeText","Data":"注意了，前面我们分析的这几个source组件，其中execsource 和 kafkasource在实际工作中是最常见的，可以满足大部分的数据采集需求。"}]}]},{"ID":"20230817161947-i9w1rg8","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230817161947-i9w1rg8","updated":"20230817161947"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"channel"}]},{"ID":"20230817161948-e54p33u","Type":"NodeParagraph","Properties":{"id":"20230817161948-e54p33u","updated":"20230817161948"},"Children":[{"Type":"NodeText","Data":"Channel：接受Source发出的数据，可以把channel理解为一个临时存储数据的管道"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"Channel的类型有很多：内存、文件，内存+文件、JDBC等"}]},{"ID":"20230817161949-4ivw0dp","Type":"NodeParagraph","Properties":{"id":"20230817161949-4ivw0dp","updated":"20230817161949"},"Children":[{"Type":"NodeText","Data":"接下来我们来分析一下"}]},{"ID":"20230817161950-3862356","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161950-3862356","updated":"20230817161950"},"Children":[{"ID":"20230817161951-jb8kdjr","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161951-jb8kdjr","updated":"20230817161951"},"Children":[{"ID":"20230817161952-ffnj2v1","Type":"NodeParagraph","Properties":{"id":"20230817161952-ffnj2v1","updated":"20230817161952"},"Children":[{"Type":"NodeText","Data":"Memory Channel：使用内存作为数据的存储"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"优点是效率高，因为就不涉及磁盘IO"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"缺点有两个"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"1：可能会丢数据，如果Flume的agent挂了，那么channel中的数据就丢失了。"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"2：内存是有限的，会存在内存不够用的情况"}]}]},{"ID":"20230817161953-t19qpw3","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161953-t19qpw3","updated":"20230817161953"},"Children":[{"ID":"20230817161954-5gzky9s","Type":"NodeParagraph","Properties":{"id":"20230817161954-5gzky9s","updated":"20230817161954"},"Children":[{"Type":"NodeText","Data":"File Channel：使用文件来作为数据的存储"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"优点是数据不会丢失"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"缺点是效率相对内存来说会有点慢，但是这个慢并没有我们想象中的那么慢，"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"所以这个也是比较常用的一种channel。"}]}]},{"ID":"20230817161955-w311hnu","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161955-w311hnu","updated":"20230817161955"},"Children":[{"ID":"20230817161956-un7jp8h","Type":"NodeParagraph","Properties":{"id":"20230817161956-un7jp8h","updated":"20230817161956"},"Children":[{"Type":"NodeText","Data":"Spillable Memory Channel：使用内存和文件作为数据存储，即先把数据存到内存中，如果内存中数据达到阈值再flush到文件中"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"优点：解决了内存不够用的问题。"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"缺点：还是存在数据丢失的风险"}]}]}]},{"ID":"20230817161957-as55hv3","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230817161957-as55hv3","updated":"20230817161957"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"sink"}]},{"ID":"20230817161958-lievn2o","Type":"NodeParagraph","Properties":{"id":"20230817161958-lievn2o","updated":"20230817161958"},"Children":[{"Type":"NodeText","Data":"Sink：从Channel中读取数据并存储到指定目的地"}]},{"ID":"20230817161959-7r2pw9l","Type":"NodeParagraph","Properties":{"id":"20230817161959-7r2pw9l","updated":"20230817161959"},"Children":[{"Type":"NodeText","Data":"Sink的表现形式有很多：打印到控制台、HDFS、Kafka等，"}]},{"ID":"20230817161960-1qcgon4","Type":"NodeBlockquote","Properties":{"id":"20230817161960-1qcgon4","updated":"20230817161960"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e ","Properties":{"id":""}},{"ID":"20230817161961-fh195b4","Type":"NodeParagraph","Properties":{"id":"20230817161961-fh195b4","updated":"20230817161961"},"Children":[{"Type":"NodeText","Data":"注意：Channel中的数据直到进入目的地才会被删除，当Sink写入目的地失败后，可以自动重写，不会造成数据丢失，这块是有一个事务保证的。"}]}]},{"ID":"20230817161962-1zjo5mt","Type":"NodeParagraph","Properties":{"id":"20230817161962-1zjo5mt","updated":"20230817161962"},"Children":[{"Type":"NodeText","Data":"常用的sink组件有："}]},{"ID":"20230817161963-pblzng8","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161963-pblzng8","updated":"20230817161963"},"Children":[{"ID":"20230817161964-9ix78r5","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161964-9ix78r5","updated":"20230817161964"},"Children":[{"ID":"20230817161965-wwieqaz","Type":"NodeParagraph","Properties":{"id":"20230817161965-wwieqaz","updated":"20230817161965"},"Children":[{"Type":"NodeText","Data":"Logger Sink：将数据作为日志处理，可以选择打印到控制台或者写到文件中，这个主要在测试的时候使用"}]}]},{"ID":"20230817161966-kdmhjlz","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161966-kdmhjlz","updated":"20230817161966"},"Children":[{"ID":"20230817161967-sb1oig6","Type":"NodeParagraph","Properties":{"id":"20230817161967-sb1oig6","updated":"20230817161967"},"Children":[{"Type":"NodeText","Data":"HDFS Sink：将数据传输到HDFS中，这个是比较常见的，主要针对离线计算的场景"}]}]},{"ID":"20230817161968-gzu0u8c","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230817161968-gzu0u8c","updated":"20230817161968"},"Children":[{"ID":"20230817161969-j0vrh4g","Type":"NodeParagraph","Properties":{"id":"20230817161969-j0vrh4g","updated":"20230817161969"},"Children":[{"Type":"NodeText","Data":"Kafka Sink：将数据发送到kafka消息队列中，这个也是比较常见的，主要针对实时计算场景，数据不落盘，实时传输，最后使用实时计算框架直接处理。"}]}]}]}]}